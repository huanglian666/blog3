import{_ as n,o as s,c as a,f as t}from"./app.3adea723.js";const p="/blog3/assets/image-20210221104746519.406197eb.png",e={},o=t(`<div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote></blockquote><h1 id="_1-elasticsearch\u5E94\u7528" tabindex="-1"><a class="header-anchor" href="#_1-elasticsearch\u5E94\u7528" aria-hidden="true">#</a> 1\uFF1Aelasticsearch\u5E94\u7528</h1><h2 id="_1-0-\u9700\u6C42\u8BBE\u8BA1" tabindex="-1"><a class="header-anchor" href="#_1-0-\u9700\u6C42\u8BBE\u8BA1" aria-hidden="true">#</a> 1.0\uFF1A\u9700\u6C42\u8BBE\u8BA1</h2><p>\u539F\u578B\uFF1A</p><p><img src="`+p+`" alt="image-202122114746519"></p><h2 id="_1-1-\u57DF\u8BBE\u8BA1" tabindex="-1"><a class="header-anchor" href="#_1-1-\u57DF\u8BBE\u8BA1" aria-hidden="true">#</a> 1.1\uFF1A\u57DF\u8BBE\u8BA1</h2><blockquote><p>\u8BBE\u8BA1\u7EF4\u5EA6</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>* \u8981\u4E0D\u8981\u5206\u8BCD\uFF1F
* \u8981\u4E0D\u8981\u5EFA\u7ACB\u7D22\u5F15\uFF1F
* \u8981\u4E0D\u8981\u5B58\u50A8\uFF1F
* \u4F7F\u7528\u54EA\u79CD\u5206\u8BCD\u5668\uFF1F
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>portal<span class="token punctuation">.</span>entity</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Id</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">DateFormat</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Document</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Field</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">FieldType</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span></span><span class="token punctuation">;</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@Document</span><span class="token punctuation">(</span>indexName <span class="token operator">=</span> <span class="token string">&quot;es-goods&quot;</span><span class="token punctuation">,</span>  shards <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> replicas <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ESGoods</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Id</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> spuId<span class="token punctuation">;</span>                        <span class="token comment">// spuId</span>

    

    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Text</span><span class="token punctuation">,</span> analyzer <span class="token operator">=</span> <span class="token string">&quot;ik_max_word&quot;</span><span class="token punctuation">,</span>store<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> goodsName<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token class-name">FieldType<span class="token punctuation">.</span>Long</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>store<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> brandId<span class="token punctuation">;</span>                       <span class="token comment">// \u54C1\u724Cid</span>
    
    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Keyword</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>store<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> brandName<span class="token punctuation">;</span>                   <span class="token comment">//\u54C1\u724C\u540D\u79F0</span>

     <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token class-name">FieldType<span class="token punctuation">.</span>Long</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>store<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> cid1id<span class="token punctuation">;</span>                        <span class="token comment">// 1\u7EA7\u5206\u7C7Bid</span>
    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Keyword</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>store<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> cat1name<span class="token punctuation">;</span>                    <span class="token comment">// 1\u7EA7\u5206\u7C7B\u540D\u79F0</span>
   
     <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token class-name">FieldType<span class="token punctuation">.</span>Long</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>store<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> cid2id<span class="token punctuation">;</span>                        <span class="token comment">// 2\u7EA7\u5206\u7C7Bid</span>
     <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Keyword</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>store<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> cat2name<span class="token punctuation">;</span>                    <span class="token comment">// 2\u7EA7\u5206\u7C7B\u540D\u79F0</span>
   
    
    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token class-name">FieldType<span class="token punctuation">.</span>Long</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>store<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> cid3id<span class="token punctuation">;</span>                        <span class="token comment">// 3\u7EA7\u5206\u7C7Bid</span>
     <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Keyword</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>store<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> cat3name<span class="token punctuation">;</span>                    <span class="token comment">// 3\u7EA7\u5206\u7C7B\u540D\u79F0</span>

	 <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token class-name">FieldType<span class="token punctuation">.</span>Date</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>store<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>format <span class="token operator">=</span> <span class="token class-name">DateFormat</span><span class="token punctuation">.</span>date_time<span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Date</span> createTime<span class="token punctuation">;</span>                    <span class="token comment">// \u521B\u5EFA\u65F6\u95F4</span>
    
    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type<span class="token operator">=</span><span class="token class-name">FieldType<span class="token punctuation">.</span>Double</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>store<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Double</span> price<span class="token punctuation">;</span>                       <span class="token comment">// \u4EF7\u683C\uFF0Cspu\u9ED8\u8BA4\u7684sku\u7684price</span>
   
    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Keyword</span><span class="token punctuation">,</span>index <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span>store<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> imageUrl<span class="token punctuation">;</span>                    <span class="token comment">// \u56FE\u7247\u5730\u5740</span>
    
    
    
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_1-2-\u7D22\u5F15\u5E93\u6570\u636E\u521D\u59CB\u5316" tabindex="-1"><a class="header-anchor" href="#_1-2-\u7D22\u5F15\u5E93\u6570\u636E\u521D\u59CB\u5316" aria-hidden="true">#</a> 1.2\uFF1A\u7D22\u5F15\u5E93\u6570\u636E\u521D\u59CB\u5316</h2><h3 id="_1-2-1-spu\u4FE1\u606F\u63A5\u53E3\u5F00\u53D1" tabindex="-1"><a class="header-anchor" href="#_1-2-1-spu\u4FE1\u606F\u63A5\u53E3\u5F00\u53D1" aria-hidden="true">#</a> 1.2.1\uFF1Aspu\u4FE1\u606F\u63A5\u53E3\u5F00\u53D1</h3><blockquote><p>\u5546\u54C1\u5FAE\u670D\u52A1\u63D0\u4F9B</p></blockquote><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WxbGoods</span><span class="token punctuation">&gt;</span></span> <span class="token function">findGoodsSpuInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-XML ext-XML line-numbers-mode"><pre class="language-XML"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;
&lt;mapper namespace=&quot;com.portal.goods.mapper.MallGoodsMapper&quot;&gt;

    &lt;!-- List&lt;WxbGoods&gt; findGoodsSpuInfo();--&gt;

    &lt;resultMap id=&quot;findGoodsSpuInfoMap&quot; type=&quot;mallgoods&quot;&gt;
        &lt;result property=&quot;spuId&quot; column=&quot;spuId&quot;&gt;&lt;/result&gt;
        &lt;result property=&quot;goodsName&quot; column=&quot;goods_name&quot;&gt;&lt;/result&gt;
        &lt;result property=&quot;price&quot; column=&quot;default_price&quot;&gt;&lt;/result&gt;
        &lt;result property=&quot;typeTemplateId&quot; column=&quot;template_id&quot;&gt;&lt;/result&gt;
        &lt;result property=&quot;albumPics&quot; column=&quot;album_pics&quot;&gt;&lt;/result&gt;
        &lt;!-- \u54C1\u724C--&gt;
        &lt;association property=&quot;brand&quot; javaType=&quot;MallGoodsBrand&quot;&gt;
            &lt;id property=&quot;id&quot; column=&quot;brand_id&quot;&gt;&lt;/id&gt;
            &lt;result property=&quot;name&quot; column=&quot;brand_name&quot;&gt;&lt;/result&gt;
        &lt;/association&gt;
        &lt;!-- \u4E00\u7EA7\u5206\u7C7B--&gt;
        &lt;association property=&quot;cat1&quot; javaType=&quot;MallGoodsCat&quot;&gt;
            &lt;id property=&quot;id&quot; column=&quot;cat1id&quot;&gt;&lt;/id&gt;
            &lt;result property=&quot;name&quot; column=&quot;cat1name&quot;&gt;&lt;/result&gt;
        &lt;/association&gt;
        &lt;!-- \u4E8C\u7EA7\u5206\u7C7B--&gt;
        &lt;association property=&quot;cat2&quot; javaType=&quot;MallGoodsCat&quot;&gt;
            &lt;id property=&quot;id&quot; column=&quot;cat2id&quot;&gt;&lt;/id&gt;
            &lt;result property=&quot;name&quot; column=&quot;cat2name&quot;&gt;&lt;/result&gt;
        &lt;/association&gt;
        &lt;!-- \u4E09\u7EA7\u5206\u7C7B--&gt;
        &lt;association property=&quot;cat3&quot; javaType=&quot;MallGoodsCat&quot;&gt;
            &lt;id property=&quot;id&quot; column=&quot;cat3id&quot;&gt;&lt;/id&gt;
            &lt;result property=&quot;name&quot; column=&quot;cat3name&quot;&gt;&lt;/result&gt;
        &lt;/association&gt;
    &lt;/resultMap&gt;


    &lt;select id=&quot;findGoodsSpuInfo&quot; resultMap=&quot;findGoodsSpuInfoMap&quot;&gt;
          SELECT
            goods.spu_id as spuId,
            goods.goods_name,
            goods.price as default_price,
            goods.album_pics,
            brand.id as brand_id,
            brand.\`name\` as brand_name,
            cat1.id as cat1id,
            cat1.\`name\` as cat1name,
            cat2.id as cat2id,
            cat2.\`name\` as cat2name,
            cat3.id as cat3id,
            cat3.\`name\` as cat3name,
            cat3.template_id

             from mall_goods goods
            LEFT JOIN mall_goods_brand brand on brand.id = goods.brand_id
            LEFT JOIN mall_goods_cat cat1 on cat1.id = goods.category1_id
            LEFT JOIN mall_goods_cat cat2 on cat2.id = goods.category2_id
            LEFT JOIN mall_goods_cat cat3 on cat3.id = goods.category3_id
			where goods.audit_status=1
    &lt;/select&gt;



&lt;/mapper&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>service\u3010\u7565\u3011</p><p>controller\u3010\u7565\u3011</p><h3 id="_1-2-2-\u641C\u7D22\u5FAE\u670D\u52A1\u642D\u5EFA" tabindex="-1"><a class="header-anchor" href="#_1-2-2-\u641C\u7D22\u5FAE\u670D\u52A1\u642D\u5EFA" aria-hidden="true">#</a> 1.2.2\uFF1A\u641C\u7D22\u5FAE\u670D\u52A1\u642D\u5EFA</h3><h3 id="_1-2-3-\u521D\u59CB\u5316\u7D22\u5F15\u5E93\u6570\u636E" tabindex="-1"><a class="header-anchor" href="#_1-2-3-\u521D\u59CB\u5316\u7D22\u5F15\u5E93\u6570\u636E" aria-hidden="true">#</a> 1.2.3\uFF1A\u521D\u59CB\u5316\u7D22\u5F15\u5E93\u6570\u636E</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code> <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">ResultVO</span> <span class="token function">goods2es</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">//\u5220\u9664\u7D22\u5F15\u5E93</span>
        template<span class="token punctuation">.</span><span class="token function">deleteIndex</span><span class="token punctuation">(</span><span class="token class-name">ESGoods</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token comment">//\u521B\u5EFA\u7D22\u5F15\u5E93</span>
        template<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token class-name">ESGoods</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        template<span class="token punctuation">.</span><span class="token function">putMapping</span><span class="token punctuation">(</span><span class="token class-name">ESGoods</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token comment">//\u83B7\u53D6\u5546\u54C1\u4FE1\u606F</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MallGoods</span><span class="token punctuation">&gt;</span></span> goodsAudited <span class="token operator">=</span> goodsApi<span class="token punctuation">.</span><span class="token function">findGoodsAudited</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>goodsAudited <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span>  <span class="token keyword">new</span> <span class="token class-name">ResultVO</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">&quot;\u540C\u6B65\u5931\u8D25&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ESGoods</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> goodsAudited<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>spu <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">//spu-&gt;esGoods</span>
            <span class="token class-name">ESGoods</span> esGoods <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ESGoods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            esGoods<span class="token punctuation">.</span><span class="token function">setSpuId</span><span class="token punctuation">(</span>spu<span class="token punctuation">.</span><span class="token function">getSpuId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            esGoods<span class="token punctuation">.</span><span class="token function">setBrandId</span><span class="token punctuation">(</span>spu<span class="token punctuation">.</span><span class="token function">getBrand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            esGoods<span class="token punctuation">.</span><span class="token function">setBrandName</span><span class="token punctuation">(</span>spu<span class="token punctuation">.</span><span class="token function">getBrand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


            esGoods<span class="token punctuation">.</span><span class="token function">setCid1id</span><span class="token punctuation">(</span>spu<span class="token punctuation">.</span><span class="token function">getCat1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            esGoods<span class="token punctuation">.</span><span class="token function">setCat1name</span><span class="token punctuation">(</span>spu<span class="token punctuation">.</span><span class="token function">getCat1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            esGoods<span class="token punctuation">.</span><span class="token function">setCid2id</span><span class="token punctuation">(</span>spu<span class="token punctuation">.</span><span class="token function">getCat2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            esGoods<span class="token punctuation">.</span><span class="token function">setCat2name</span><span class="token punctuation">(</span>spu<span class="token punctuation">.</span><span class="token function">getCat2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            esGoods<span class="token punctuation">.</span><span class="token function">setCid3id</span><span class="token punctuation">(</span>spu<span class="token punctuation">.</span><span class="token function">getCat3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            esGoods<span class="token punctuation">.</span><span class="token function">setCat3name</span><span class="token punctuation">(</span>spu<span class="token punctuation">.</span><span class="token function">getCat3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            esGoods<span class="token punctuation">.</span><span class="token function">setCreateTime</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            esGoods<span class="token punctuation">.</span><span class="token function">setGoodsName</span><span class="token punctuation">(</span>spu<span class="token punctuation">.</span><span class="token function">getGoodsName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            esGoods<span class="token punctuation">.</span><span class="token function">setPrice</span><span class="token punctuation">(</span>spu<span class="token punctuation">.</span><span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">doubleValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>spu<span class="token punctuation">.</span><span class="token function">getAlbumPics</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> imgArr <span class="token operator">=</span> spu<span class="token punctuation">.</span><span class="token function">getAlbumPics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>imgArr <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> imgArr<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    esGoods<span class="token punctuation">.</span><span class="token function">setImageUrl</span><span class="token punctuation">(</span>imgArr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">return</span> esGoods<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



        template<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResultVO</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token string">&quot;\u540C\u6B65\u6210\u529F&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_1-3-\u5546\u54C1\u641C\u7D22\u529F\u80FD\u62C6\u89E3" tabindex="-1"><a class="header-anchor" href="#_1-3-\u5546\u54C1\u641C\u7D22\u529F\u80FD\u62C6\u89E3" aria-hidden="true">#</a> 1.3\uFF1A\u5546\u54C1\u641C\u7D22\u529F\u80FD\u62C6\u89E3</h2><div class="language-txt ext-txt line-numbers-mode"><pre class="language-txt"><code>\u5173\u952E\u5B57\u641C\u7D22
   \u9700\u6C42\uFF1A\u5173\u952E\u5B57\u5339\u914D \u5546\u54C1\u540D\u79F0\u3001\u54C1\u724C\u540D\u79F0\u3001\u7B2C\u4E09\u7EA7\u5206\u7C7B\u540D\u79F0
   \u4F7F\u7528bool\u67E5\u8BE2\u3010should\u3011 
   
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_1-4-\u5173\u952E\u5B57\u641C\u7D22\u63A5\u53E3\u5F00\u53D1" tabindex="-1"><a class="header-anchor" href="#_1-4-\u5173\u952E\u5B57\u641C\u7D22\u63A5\u53E3\u5F00\u53D1" aria-hidden="true">#</a> 1.4\uFF1A\u5173\u952E\u5B57\u641C\u7D22\u63A5\u53E3\u5F00\u53D1</h2><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code> <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">PageResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ESGoods</span><span class="token punctuation">&gt;</span></span> <span class="token function">search</span><span class="token punctuation">(</span><span class="token class-name">Map</span> searchMap<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">//1.\u6784\u5EFA\u67E5\u8BE2\u6761\u4EF6</span>
        <span class="token class-name">BoolQueryBuilder</span> boolQueryBuilder <span class="token operator">=</span> <span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">boolQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//match[goodsName]</span>
        <span class="token class-name">MatchQueryBuilder</span> goodsNameQueryBuilder <span class="token operator">=</span> <span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span>
            <span class="token function">matchQuery</span><span class="token punctuation">(</span><span class="token string">&quot;goodsName&quot;</span><span class="token punctuation">,</span>searchMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;keyword&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token comment">//match[brandName]</span>
        <span class="token class-name">MatchQueryBuilder</span> brandNameQueryBuilder <span class="token operator">=</span> <span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span>
            <span class="token function">matchQuery</span><span class="token punctuation">(</span><span class="token string">&quot;brandName&quot;</span><span class="token punctuation">,</span>searchMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;keyword&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token comment">//match[cat3name]</span>
        <span class="token class-name">MatchQueryBuilder</span> cat3nameQueryBuilder <span class="token operator">=</span> <span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span>
            <span class="token function">matchQuery</span><span class="token punctuation">(</span><span class="token string">&quot;cat3name&quot;</span><span class="token punctuation">,</span>searchMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;keyword&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        boolQueryBuilder<span class="token punctuation">.</span><span class="token function">should</span><span class="token punctuation">(</span>goodsNameQueryBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
        boolQueryBuilder<span class="token punctuation">.</span><span class="token function">should</span><span class="token punctuation">(</span>brandNameQueryBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
        boolQueryBuilder<span class="token punctuation">.</span><span class="token function">should</span><span class="token punctuation">(</span>cat3nameQueryBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>



        <span class="token class-name">PageRequest</span> page <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token comment">//2.\u8BBE\u7F6E\u5206\u9875</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>searchMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;page&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>searchMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;size&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

            <span class="token class-name">Integer</span> pageNow <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">)</span> searchMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;page&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Integer</span> size <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">)</span> searchMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;size&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            page <span class="token operator">=</span> <span class="token class-name">PageRequest</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>pageNow<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//3.\u8BBE\u7F6E\u9AD8\u4EAE\u57DF</span>
        <span class="token class-name">HighlightBuilder</span> goodsNameHighLight <span class="token operator">=</span> <span class="token function">getHighlightBuilder</span><span class="token punctuation">(</span><span class="token string">&quot;goodsName&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token class-name">NativeSearchQuery</span> build <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NativeSearchQueryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">withQuery</span><span class="token punctuation">(</span>boolQueryBuilder<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">withPageable</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">withHighlightBuilder</span><span class="token punctuation">(</span>goodsNameHighLight<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">SearchHits</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ESGoods</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> template<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>build<span class="token punctuation">,</span> <span class="token class-name">ESGoods</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token comment">//\u603B\u8BB0\u5F55\u6570</span>
        <span class="token keyword">long</span> totalHits <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getTotalHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u53D6\u5F53\u524D\u9875\u6570\u636E</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SearchHit</span><span class="token punctuation">&lt;</span><span class="token class-name">ESGoods</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> searchHits <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getSearchHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ESGoods</span><span class="token punctuation">&gt;</span></span> esGoodsList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        searchHits<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>hit<span class="token operator">-&gt;</span><span class="token punctuation">{</span>
            <span class="token comment">//\u53D6\u6587\u6863\u4FE1\u606F</span>
            <span class="token class-name">ESGoods</span> content <span class="token operator">=</span> hit<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//\u53D6\u9AD8\u4EAE</span>
            <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> highlightFields <span class="token operator">=</span> hit<span class="token punctuation">.</span><span class="token function">getHighlightFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> keySet <span class="token operator">=</span> highlightFields<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            keySet<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>key<span class="token operator">-&gt;</span><span class="token punctuation">{</span>
                <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> highlightFields<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">&quot;goodsName&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token class-name">String</span> highlightValue <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    content<span class="token punctuation">.</span><span class="token function">setGoodsName</span><span class="token punctuation">(</span>highlightValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            esGoodsList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>




        <span class="token comment">//pageresult</span>
        <span class="token class-name">PageResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ESGoods</span><span class="token punctuation">&gt;</span></span> pageResult <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PageResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pageResult<span class="token punctuation">.</span><span class="token function">setTotal</span><span class="token punctuation">(</span>totalHits<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pageResult<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>esGoodsList<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> pageResult<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// \u8BBE\u7F6E\u9AD8\u4EAE\u5B57\u6BB5</span>
    <span class="token keyword">private</span> <span class="token class-name">HighlightBuilder</span> <span class="token function">getHighlightBuilder</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> fields<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u9AD8\u4EAE\u6761\u4EF6</span>
        <span class="token class-name">HighlightBuilder</span> highlightBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HighlightBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//\u751F\u6210\u9AD8\u4EAE\u67E5\u8BE2\u5668</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> field <span class="token operator">:</span> fields<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            highlightBuilder<span class="token punctuation">.</span><span class="token function">field</span><span class="token punctuation">(</span>field<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//\u9AD8\u4EAE\u67E5\u8BE2\u5B57\u6BB5</span>
        <span class="token punctuation">}</span>
        highlightBuilder<span class="token punctuation">.</span><span class="token function">requireFieldMatch</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">//\u5982\u679C\u8981\u591A\u4E2A\u5B57\u6BB5\u9AD8\u4EAE,\u8FD9\u9879\u8981\u4E3Afalse</span>
        highlightBuilder<span class="token punctuation">.</span><span class="token function">preTags</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;span style=\\&quot;color:red\\&quot;&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//\u9AD8\u4EAE\u8BBE\u7F6E</span>
        highlightBuilder<span class="token punctuation">.</span><span class="token function">postTags</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;/span&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u4E0B\u9762\u8FD9\u4E24\u9879,\u5982\u679C\u4F60\u8981\u9AD8\u4EAE\u5982\u6587\u5B57\u5185\u5BB9\u7B49\u6709\u5F88\u591A\u5B57\u7684\u5B57\u6BB5,\u5FC5\u987B\u914D\u7F6E,\u4E0D\u7136\u4F1A\u5BFC\u81F4\u9AD8\u4EAE\u4E0D\u5168,\u6587\u7AE0\u5185\u5BB9\u7F3A\u5931\u7B49</span>
        highlightBuilder<span class="token punctuation">.</span><span class="token function">fragmentSize</span><span class="token punctuation">(</span><span class="token number">800000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//\u6700\u5927\u9AD8\u4EAE\u5206\u7247\u6570</span>
        highlightBuilder<span class="token punctuation">.</span><span class="token function">numOfFragments</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//\u4ECE\u7B2C\u4E00\u4E2A\u5206\u7247\u83B7\u53D6\u9AD8\u4EAE\u7247\u6BB5</span>

        <span class="token keyword">return</span> highlightBuilder<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_1-4-\u524D\u7AEF\u8054\u8C03" tabindex="-1"><a class="header-anchor" href="#_1-4-\u524D\u7AEF\u8054\u8C03" aria-hidden="true">#</a> 1.4\uFF1A\u524D\u7AEF\u8054\u8C03</h2><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>
	<span class="token operator">&lt;</span>script <span class="token operator">&gt;</span>

		<span class="token keyword">var</span> vm <span class="token operator">=</span>  <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			<span class="token literal-property property">el</span><span class="token operator">:</span><span class="token string">&quot;#app&quot;</span><span class="token punctuation">,</span>
			<span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">{</span>
				<span class="token literal-property property">searchMap</span><span class="token operator">:</span><span class="token punctuation">{</span>
					<span class="token literal-property property">page</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
					<span class="token literal-property property">size</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span>
				<span class="token literal-property property">goodsList</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
				<span class="token literal-property property">total</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
				<span class="token literal-property property">pages</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
				
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token function">search</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
					wfx<span class="token punctuation">.</span>http<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/search&quot;</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>searchMap<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
						console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token keyword">this</span><span class="token punctuation">.</span>goodsList <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
						<span class="token keyword">this</span><span class="token punctuation">.</span>total <span class="token operator">=</span> res<span class="token punctuation">.</span>total<span class="token punctuation">;</span>
						<span class="token keyword">this</span><span class="token punctuation">.</span>pages <span class="token operator">=</span> wfx<span class="token punctuation">.</span><span class="token function">pageTotal</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>total<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>searchMap<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>	
					<span class="token punctuation">}</span><span class="token punctuation">)</span>	
				<span class="token punctuation">}</span><span class="token punctuation">,</span>
				
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			
			<span class="token punctuation">}</span><span class="token punctuation">,</span>	
		<span class="token punctuation">}</span><span class="token punctuation">)</span>

	<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>
         
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div>`,28),c=[o];function l(i,u){return s(),a("div",null,c)}const d=n(e,[["render",l],["__file","03_ElasticSearch\u5728\u9879\u76EE\u4E2D\u505A\u641C\u7D22\u7684\u5E94\u7528.html.vue"]]);export{d as default};
